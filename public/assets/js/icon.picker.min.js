var option_icons_content = function (checked) {
    var content = '<div class="custom-scroll icon-picker-container">';
    content += '<p class="bold font-montserrat">Select Icon</p><ul class="icon-picker-group m-b-20">'; 
    if (typeof option_icons !== 'undefined' && Object.keys(option_icons).length > 0) {
        for (var key in option_icons) {
            if (option_icons.hasOwnProperty(key)) {
                if(key == 'no-icon') {
                    content += '<li><label class="custom-icon-picker '+(key == 'no-icon' ? 'no-icon' : '')+' '+(checked == key ? 'selected-icon-label' : '')+'" data-value="'+key+'">'+option_icons[key]+'</label></li>';
                }
                else {
                    content += '<li><label class="custom-icon-picker '+(key == 'no-icon' ? 'no-icon' : '')+' '+(checked == key ? 'selected-icon-label' : '')+'" data-value="'+key+'" uk-icon="'+option_icons[key]+'"></label></li>';
                }
            }
        }
    }
    content += '</ul>';

    if (typeof option_custom_icons !== 'undefined' && Object.keys(option_custom_icons).length > 0) {
        content += '<p class="bold font-montserrat custom-icon-set">Select Custom Icon</p><ul class="icon-picker-group">'; 
        for (var key in option_custom_icons) {
            if (option_custom_icons.hasOwnProperty(key)) {
                content += '<li><label class="custom-icon-picker '+(checked == key ? 'selected-icon-label' : '')+'" data-value="'+key+'">'+option_custom_icons[key]+'</label></li>';
            }
        }
        content += '</ul>';
    }

    if (typeof option_social_media_icons !== 'undefined' && Object.keys(option_social_media_icons).length > 0) {
        content += '<p class="bold font-montserrat custom-icon-set">Select Social Media Icon</p><ul class="icon-picker-group">'; 
        for (var key in option_social_media_icons) {
            if (option_social_media_icons.hasOwnProperty(key)) {
                content += '<li><label class="custom-icon-picker '+(key == 'no-icon' ? 'no-icon' : '')+' '+(checked == key ? 'selected-icon-label' : '')+'" data-value="'+key+'" uk-icon="'+option_social_media_icons[key]+'"></label></li>';
            }
        }
        content += '</ul>';
    }

    if (Object.keys(option_icons).length == 0 && Object.keys(option_custom_icons).length == 0 && Object.keys(option_social_media_icons).length == 0) {
        content += '<p>No Icon set available at this moment.</p>';
    }
    content += '</div>';
    return content;
}
var load_icon_option = function() {
    if ($('.btn-icon-picker').length > 0) {
        tippy('.btn-icon-picker', {
            content: 'Loading...',
            interactive: true,
            placement: 'top',
            theme: 'light-border',
            animateFill: false, 
            animation: 'fade',
            flipOnUpdate: true,
            trigger: 'click',
            onShown(instance) { 
                instance.setContent(option_icons_content($('.btn-icon-picker.tippy-active').parents('.icon-picker-parent').find('.selected-icon').val()));
            }
        })
    }
}
$(document).on('click', '.custom-icon-trigger', function (e) {
    e.preventDefault(); 
    $('.custom-scroll.icon-picker-container').animate({ scrollTop: 320 }, 500);
});
$(document).on('click', '.custom-icon-picker', function (e) {
    e.preventDefault();
    var $this = $(this);
    var icon  = $this.data('value'); 
    var $activeIcon = $('.btn-icon-picker.tippy-active');
    $activeIcon.parents('.icon-picker-parent').find('.selected-icon').val(icon);
    
    var check = true;
    if (Object.keys(option_icons).length > 0 && option_icons.hasOwnProperty(icon)) {
        if(icon == 'no-icon') {
            $activeIcon.find('.icon-content').html(option_icons[icon]); check = false;
        }
        else {
            $activeIcon.find('.icon-content').html('<i uk-icon="'+option_icons[icon]+'">'); check = false;
        }
    }
    if (typeof option_custom_icons !== 'undefined' && Object.keys(option_custom_icons).length > 0 && option_custom_icons.hasOwnProperty(icon)) {
        $activeIcon.find('.icon-content').html(option_custom_icons[icon]); check = false;
    }
    if (Object.keys(option_social_media_icons).length > 0 && option_social_media_icons.hasOwnProperty(icon)) {
        $activeIcon.find('.icon-content').html('<i uk-icon="'+option_social_media_icons[icon]+'">'); check = false;
    }
    if ((Object.keys(option_icons).length == 0 && Object.keys(option_custom_icons).length == 0 && Object.keys(option_social_media_icons).length == 0) || check) {
       $activeIcon.find('.icon-content').html(option_icons['no-icon']);
    }

    $('.custom-icon-picker.selected-icon-label').removeClass('selected-icon-label');
    $this.addClass('selected-icon-label');
});
load_icon_option();