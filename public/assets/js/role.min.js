$(document).on('change', '.permit-all', function (e) {
    if ($(this).is(':checked')) {
        $('.permit-role').prop('checked', true);
    }
});
$(document).on('click', '.permit-module-select', function (e) {
    e.preventDefault();
    $(this).parents('.permit-parent').find('.permit-role').prop('checked', true);
});
$(document).on('click', '.permit-module-clear', function (e) {
    e.preventDefault();
    $(this).parents('.permit-parent').find('.permit-role').prop('checked', false);
});
$(document).on('change', '.permit-pre-role', function (e) {
	var $this = $(this); 
    $.ajax({
        url: $this.parents('form').data('role-permissions'),
        type: "post",
        data: { id: $this.val() }, 
        async: false,
        success: function (response) {
            if (response != false) { 
            	$('.permit-role').prop('checked', false);
             	Object.entries(response).forEach(([key, permit]) => { $('#permission-'+key).prop('checked', true); });
            }
        }
    });
});